<!DOCTYPE html>
<html lang="en">

<head>
  <!--헤드내용 include -->
  <% include ../../partials/head.ejs %>
    <% include ../../partials/scripts.ejs %>

      <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
      <link rel="stylesheet" href="/stylesheets/summernote.css">
</head>

<body>
  <form method="get" action="/community/<%= data.board_no %>" id="form_edit">
    <table>
      <label>게시판 </label>
      <!-- TODO : SELECT값 data.board_department 로 지정하기 -->
      <select name="board_department" , id="board_department">
        <option value="999">전체학과</option>
        <option value="1">기계공학과</option>
        <option value="2">기계설계공학과</option>
        <option value="3">메카트로닉스공학과</option>
        <option value="4">전자공학부</option>
        <option value="5">컴퓨터공학부</option>
        <option value="6">게임공학부</option>
        <option value="7">신소재공학과</option>
        <option value="8">생명화학공학과</option>
        <option value="9">디자인학부</option>
        <option value="10">경영학부</option>
        <option value="11">나노광공학과</option>
        <option value="12">에너지전기공학과</option>
      </select>
      <br>
      <label>제목 </label>
      <input type="text" name="title" placeholder="제목을 입력하세요" value="<%= data.board_title %>" maxlength="255" required>
      <br>
      <br>
      <textarea name="content" class="summernote" id="content" required rows="30" autofocus cols="130"><%= data.board_content %></textarea>
    </table>
    <hr align="left" width="70%">
    <button href="/community/<%= data.board_no %>">뒤로가기</button>
    <input type="submit" id="subbtn" value="수정">
  </form>

  <script>
    $(document).ready(function () {
      $('.summernote').summernote({
        height: 300,
        tabsize: 2,
        focus: true
      });
      $('#subbtn').on('click', function () {
        $('textarea[name="content"]').val($('.summernote').summernote('code'));
        $('form').submit();
      });
    })


    $('#form_edit').submit(() => {
      let url = `/community/<%= data.board_no %>`
      $.ajax({
        type: 'PUT',
        url: url,
        data: $('#form_edit').serialize(),
        success: (result) => {
          if (result['result']) {
            window.location.href = url;
          }
        },
        error : function(result) {
            alert('세션이 종료되었습니다.')
            window.location.href = "/login";
          }
      })
    })


  </script>
</body>

</html>